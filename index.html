<!DOCTYPE html>

<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ê®°Ë©¶„Çø„Ç§„Éû„Éº</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

```
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 20px;
    }

    .container {
        background: white;
        border-radius: 20px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        padding: 40px;
        max-width: 800px;
        width: 100%;
        position: relative;
    }

    .chime-test-btn {
        position: absolute;
        top: 20px;
        right: 20px;
        padding: 10px 20px;
        background: #f0f0f0;
        border: 2px solid #667eea;
        border-radius: 8px;
        cursor: pointer;
        font-size: 0.9em;
        transition: all 0.3s;
        color: #667eea;
        font-weight: bold;
    }

    .chime-test-btn:hover {
        background: #667eea;
        color: white;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
    }

    h1 {
        text-align: center;
        color: #333;
        margin-bottom: 30px;
        font-size: 2em;
    }

    .current-time {
        text-align: center;
        margin-bottom: 20px;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    #clockCanvas {
        border-radius: 50%;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
    }

    .current-subject {
        text-align: center;
        font-size: 1.8em;
        padding: 20px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 10px;
        margin-bottom: 30px;
        min-height: 80px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .time-remaining {
        text-align: center;
        font-size: 1.5em;
        color: #666;
        margin-bottom: 30px;
    }

    .schedule {
        background: #f8f9fa;
        border-radius: 10px;
        padding: 20px;
        max-height: 400px;
        overflow-y: auto;
    }

    .schedule-item {
        padding: 15px;
        margin-bottom: 10px;
        border-radius: 8px;
        background: white;
        border-left: 4px solid #ddd;
        transition: all 0.3s;
    }

    .schedule-item.active {
        background: #e3f2fd;
        border-left-color: #667eea;
        transform: scale(1.02);
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
    }

    .schedule-item.completed {
        opacity: 0.5;
        background: #f5f5f5;
    }

    .schedule-item-time {
        font-weight: bold;
        color: #667eea;
        font-size: 1.1em;
    }

    .schedule-item-subject {
        color: #333;
        font-size: 1.2em;
        margin-top: 5px;
    }

    .controls {
        margin-top: 20px;
        display: flex;
        gap: 10px;
        justify-content: center;
    }

    button {
        padding: 12px 30px;
        font-size: 1em;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s;
        font-weight: bold;
    }

    .start-btn {
        background: #667eea;
        color: white;
    }

    .start-btn:hover {
        background: #5568d3;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }

    .reset-btn {
        background: #e74c3c;
        color: white;
    }

    .reset-btn:hover {
        background: #c0392b;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(231, 76, 60, 0.4);
    }

    .status {
        text-align: center;
        margin-top: 20px;
        font-size: 1em;
        color: #666;
    }
</style>
```

</head>
<body>
    <div class="container">
        <button class="chime-test-btn" onclick="playChime()">üîî „ÉÅ„É£„Ç§„É†Á¢∫Ë™ç</button>

```
    <h1>üìù Ê®°Ë©¶„Çø„Ç§„Éû„Éº</h1>
    
    <div class="current-time">
        <canvas id="clockCanvas" width="250" height="250"></canvas>
    </div>
    
    <div class="current-subject" id="currentSubject">
        ÈñãÂßã„Éú„Çø„É≥„ÇíÊäº„Åó„Å¶„Åè„Å†„Åï„ÅÑ
    </div>
    
    <div class="time-remaining" id="timeRemaining"></div>
    
    <div class="controls">
        <button class="start-btn" id="startBtn" onclick="startTimer()">ÈñãÂßã</button>
        <button class="reset-btn" onclick="resetTimer()">„É™„Çª„ÉÉ„Éà</button>
    </div>
    
    <div class="status" id="status"></div>
    
    <div class="schedule" id="schedule"></div>
</div>

<script>
    let startTime = null;
    let timerInterval = null;
    let scheduleData = [];
    let audioContext = null;

    // „Ç¢„Éä„É≠„Ç∞ÊôÇË®à„ÇíÊèèÁîª„Åô„ÇãÈñ¢Êï∞
    function drawClock() {
        const canvas = document.getElementById('clockCanvas');
        const ctx = canvas.getContext('2d');
        const now = new Date();
        const radius = canvas.width / 2;
        
        // „Ç≠„É£„É≥„Éê„Çπ„Çí„ÇØ„É™„Ç¢
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        // ÊôÇË®à„ÅÆËÉåÊôØ
        ctx.beginPath();
        ctx.arc(radius, radius, radius - 10, 0, 2 * Math.PI);
        ctx.fillStyle = 'white';
        ctx.fill();
        ctx.strokeStyle = '#667eea';
        ctx.lineWidth = 8;
        ctx.stroke();
        
        // ‰∏≠ÂøÉÁÇπ
        ctx.translate(radius, radius);
        
        // Êï∞Â≠ó„ÇíÊèèÁîª
        ctx.font = '20px Arial';
        ctx.fillStyle = '#333';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        for (let num = 1; num <= 12; num++) {
            const ang = num * Math.PI / 6;
            const x = (radius - 35) * Math.sin(ang);
            const y = -(radius - 35) * Math.cos(ang);
            ctx.fillText(num.toString(), x, y);
        }
        
        // ÊôÇÂàª„ÅÆÂèñÂæó
        const hour = now.getHours() % 12;
        const minute = now.getMinutes();
        const second = now.getSeconds();
        
        // ÊôÇÈáù
        const hourAngle = (hour * Math.PI / 6) + (minute * Math.PI / 360);
        ctx.save();
        ctx.rotate(hourAngle);
        ctx.strokeStyle = '#333';
        ctx.lineWidth = 6;
        ctx.lineCap = 'round';
        ctx.beginPath();
        ctx.moveTo(0, 0);
        ctx.lineTo(0, -(radius - 80));
        ctx.stroke();
        ctx.restore();
        
        // ÂàÜÈáù
        const minuteAngle = (minute * Math.PI / 30) + (second * Math.PI / 1800);
        ctx.save();
        ctx.rotate(minuteAngle);
        ctx.strokeStyle = '#667eea';
        ctx.lineWidth = 4;
        ctx.lineCap = 'round';
        ctx.beginPath();
        ctx.moveTo(0, 0);
        ctx.lineTo(0, -(radius - 50));
        ctx.stroke();
        ctx.restore();
        
        // ÁßíÈáù
        const secondAngle = second * Math.PI / 30;
        ctx.save();
        ctx.rotate(secondAngle);
        ctx.strokeStyle = '#e74c3c';
        ctx.lineWidth = 2;
        ctx.lineCap = 'round';
        ctx.beginPath();
        ctx.moveTo(0, 0);
        ctx.lineTo(0, -(radius - 40));
        ctx.stroke();
        ctx.restore();
        
        // ‰∏≠ÂøÉ„ÅÆÂÜÜ
        ctx.beginPath();
        ctx.arc(0, 0, 8, 0, 2 * Math.PI);
        ctx.fillStyle = '#667eea';
        ctx.fill();
        
        ctx.translate(-radius, -radius);
    }

    // „ÉÅ„É£„Ç§„É†Èü≥„ÇíÁîüÊàê„Åô„ÇãÈñ¢Êï∞Ôºà„Ç¶„Çß„Çπ„Éà„Éü„É≥„Çπ„Çø„Éº„ÅÆÈêòÈ¢® √ó 2„Çª„ÉÉ„ÉàÔºâ
    function playChime() {
        if (!audioContext) {
            audioContext = new (window.AudioContext || window.webkitAudioContext)();
        }

        // „Ç¶„Çß„Çπ„Éà„Éü„É≥„Çπ„Çø„Éº„ÅÆÈêò„ÅÆ„É°„É≠„Éá„Ç£
        // ÂâçÂçä: „Éï„Ç°„Éª„É©„Éª„ÇΩ„Éª„Éâ (F4„ÉªA4„ÉªG4„ÉªC4)
        const melody1 = [
            { freq: 349.23, duration: 0.5 },    // F4 („Éï„Ç°)
            { freq: 440.00, duration: 0.5 },    // A4 („É©)
            { freq: 392.00, duration: 0.5 },    // G4 („ÇΩ)
            { freq: 261.63, duration: 0.8 }     // C4 („Éâ)
        ];

        // ÂæåÂçä: „Éï„Ç°„Éª„ÇΩ„Éª„É©„Éª„Éï„Ç° (F4„ÉªG4„ÉªA4„ÉªF4)
        const melody2 = [
            { freq: 349.23, duration: 0.5 },    // F4 („Éï„Ç°)
            { freq: 392.00, duration: 0.5 },    // G4 („ÇΩ)
            { freq: 440.00, duration: 0.5 },    // A4 („É©)
            { freq: 349.23, duration: 0.8 }     // F4 („Éï„Ç°)
        ];

        const now = audioContext.currentTime;
        let currentTime = 0;

        // 2„Çª„ÉÉ„ÉàÁπ∞„ÇäËøî„Åô
        for (let set = 0; set < 2; set++) {
            // ÂâçÂçä
            melody1.forEach((note) => {
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = note.freq;
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0, now + currentTime);
                gainNode.gain.linearRampToValueAtTime(0.3, now + currentTime + 0.05);
                gainNode.gain.exponentialRampToValueAtTime(0.01, now + currentTime + note.duration);
                
                oscillator.start(now + currentTime);
                oscillator.stop(now + currentTime + note.duration);
                
                currentTime += note.duration + 0.1;
            });
            
            // ÈñìÈöî
            currentTime += 0.3;
            
            // ÂæåÂçä
            melody2.forEach((note) => {
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = note.freq;
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0, now + currentTime);
                gainNode.gain.linearRampToValueAtTime(0.3, now + currentTime + 0.05);
                gainNode.gain.exponentialRampToValueAtTime(0.01, now + currentTime + note.duration);
                
                oscillator.start(now + currentTime);
                oscillator.stop(now + currentTime + note.duration);
                
                currentTime += note.duration + 0.1;
            });
            
            // „Çª„ÉÉ„ÉàÈñì„ÅÆÈñìÈöî
            if (set === 0) {
                currentTime += 0.4;
            }
        }
    }

    // ‰∫àÈà¥Èü≥„ÇíÁîüÊàê„Åô„ÇãÈñ¢Êï∞ÔºàÁü≠„ÅÑÂçòÈü≥Ôºâ
    function playPreChime() {
        if (!audioContext) {
            audioContext = new (window.AudioContext || window.webkitAudioContext)();
        }

        const now = audioContext.currentTime;
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();
        
        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);
        
        oscillator.frequency.value = 880; // È´ò„ÇÅ„ÅÆÈü≥
        oscillator.type = 'sine';
        
        gainNode.gain.setValueAtTime(0, now);
        gainNode.gain.linearRampToValueAtTime(0.25, now + 0.01);
        gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.6);
        
        oscillator.start(now);
        oscillator.stop(now + 0.6);
    }

    // „Çπ„Ç±„Ç∏„É•„Éº„É´„ÇíÂàùÊúüÂåñ
    function initSchedule() {
        const now = new Date();
        
        scheduleData = [
            { time: 0, duration: 10, subject: 'Ê∫ñÂÇôÊôÇÈñì', chime: false },
            { time: 10, duration: 50, subject: 'ÂõΩË™û', chime: true },
            { time: 65, duration: 0, subject: '‰∫àÈà¥', chime: true, isPreChime: true },
            { time: 70, duration: 50, subject: 'Ëã±Ë™û', chime: true },
            { time: 125, duration: 0, subject: '‰∫àÈà¥', chime: true, isPreChime: true },
            { time: 130, duration: 50, subject: 'Êï∞Â≠¶', chime: true },
            { time: 185, duration: 50, subject: 'ÁêÜÁßë', chime: true },
            { time: 240, duration: 0, subject: '‰∫àÈà¥', chime: true, isPreChime: true },
            { time: 245, duration: 50, subject: 'Á§æ‰ºö', chime: true }
        ];

        // „Çπ„Ç±„Ç∏„É•„Éº„É´Ë°®Á§∫„Çí‰ΩúÊàê
        const scheduleDiv = document.getElementById('schedule');
        scheduleDiv.innerHTML = '';
        
        scheduleData.forEach((item, index) => {
            const div = document.createElement('div');
            div.className = 'schedule-item';
            div.id = `schedule-${index}`;
            
            const startMinutes = item.time;
            const startHour = Math.floor(startMinutes / 60);
            const startMin = startMinutes % 60;
            
            let timeText;
            if (item.duration === 0) {
                timeText = `${String(startHour).padStart(2, '0')}:${String(startMin).padStart(2, '0')}`;
            } else {
                const endMinutes = item.time + item.duration;
                const endHour = Math.floor(endMinutes / 60);
                const endMin = endMinutes % 60;
                timeText = `${String(startHour).padStart(2, '0')}:${String(startMin).padStart(2, '0')} ÔΩû ${String(endHour).padStart(2, '0')}:${String(endMin).padStart(2, '0')}`;
            }
            
            div.innerHTML = `
                <div class="schedule-item-time">${timeText}</div>
                <div class="schedule-item-subject">${item.subject}${item.duration > 0 ? ` (${item.duration}ÂàÜ)` : ''}</div>
            `;
            scheduleDiv.appendChild(div);
        });
    }

    function startTimer() {
        if (timerInterval) return;
        
        startTime = new Date();
        document.getElementById('startBtn').disabled = true;
        document.getElementById('status').textContent = '„Çø„Ç§„Éû„ÉºÂÆüË°å‰∏≠...';
        
        // ÂàùÂõû„ÅÆ„ÉÅ„É£„Ç§„É†„ÇíÈ≥¥„Çâ„ÅôÔºàÊ∫ñÂÇôÊôÇÈñìÈñãÂßãÔºâ
        playChime();
        
        timerInterval = setInterval(updateTimer, 100);
        updateTimer();
    }

    function updateTimer() {
        const now = new Date();
        const elapsedSeconds = Math.floor((now - startTime) / 1000); // ÁµåÈÅéÁßíÊï∞
        const elapsed = Math.floor(elapsedSeconds / 60); // ÁµåÈÅéÂàÜÊï∞
        
        // „Ç¢„Éä„É≠„Ç∞ÊôÇË®à„ÇíÊèèÁîª
        drawClock();
        
        // ÁèæÂú®„ÅÆ„Çπ„Ç±„Ç∏„É•„Éº„É´„Ç¢„Ç§„ÉÜ„É†„ÇíË¶ã„Å§„Åë„Çã
        let currentItem = null;
        let currentIndex = -1;
        
        for (let i = scheduleData.length - 1; i >= 0; i--) {
            if (elapsed >= scheduleData[i].time) {
                currentItem = scheduleData[i];
                currentIndex = i;
                break;
            }
        }
        
        // „ÉÅ„É£„Ç§„É†„ÇíÈ≥¥„Çâ„ÅôÂá¶ÁêÜ
        scheduleData.forEach((item, index) => {
            if (item.chime && elapsed === item.time && !item.chimed) {
                item.chimed = true;
                if (item.isPreChime) {
                    playPreChime();
                } else {
                    playChime();
                }
            }
        });
        
        // „Çπ„Ç±„Ç∏„É•„Éº„É´„Ç¢„Ç§„ÉÜ„É†„ÅÆ„Éè„Ç§„É©„Ç§„ÉàÊõ¥Êñ∞
        scheduleData.forEach((item, index) => {
            const div = document.getElementById(`schedule-${index}`);
            if (index < currentIndex) {
                div.className = 'schedule-item completed';
            } else if (index === currentIndex) {
                div.className = 'schedule-item active';
            } else {
                div.className = 'schedule-item';
            }
        });
        
        if (currentItem) {
            document.getElementById('currentSubject').textContent = currentItem.subject;
            
            // ÊÆã„ÇäÊôÇÈñì„ÇíË®àÁÆó
            if (currentItem.duration > 0) {
                const endTimeSeconds = (currentItem.time + currentItem.duration) * 60;
                const remainingSeconds = endTimeSeconds - elapsedSeconds;
                
                if (remainingSeconds > 0) {
                    const remMin = Math.floor(remainingSeconds / 60);
                    const remSec = remainingSeconds % 60;
                    document.getElementById('timeRemaining').textContent = 
                        `ÊÆã„ÇäÊôÇÈñì: ${remMin}ÂàÜ${String(remSec).padStart(2, '0')}Áßí`;
                } else {
                    document.getElementById('timeRemaining').textContent = '';
                }
            } else {
                document.getElementById('timeRemaining').textContent = '';
            }
        }
        
        // ÂÖ®„Å¶ÂÆå‰∫Ü„Åó„Åü„ÅãÁ¢∫Ë™ç
        const lastItem = scheduleData[scheduleData.length - 1];
        if (elapsed >= lastItem.time + lastItem.duration) {
            clearInterval(timerInterval);
            timerInterval = null;
            document.getElementById('currentSubject').textContent = 'Ê®°Ë©¶ÁµÇ‰∫Ü';
            document.getElementById('timeRemaining').textContent = '„ÅäÁñ≤„ÇåÊßò„Åß„Åó„ÅüÔºÅ';
            document.getElementById('status').textContent = '';
            document.getElementById('startBtn').disabled = false;
            playChime();
        }
    }

    function resetTimer() {
        if (timerInterval) {
            clearInterval(timerInterval);
            timerInterval = null;
        }
        
        startTime = null;
        drawClock();
        document.getElementById('currentSubject').textContent = 'ÈñãÂßã„Éú„Çø„É≥„ÇíÊäº„Åó„Å¶„Åè„Å†„Åï„ÅÑ';
        document.getElementById('timeRemaining').textContent = '';
        document.getElementById('status').textContent = '';
        document.getElementById('startBtn').disabled = false;
        
        // „ÉÅ„É£„Ç§„É†„Éï„É©„Ç∞„Çí„É™„Çª„ÉÉ„Éà
        scheduleData.forEach(item => {
            item.chimed = false;
        });
        
        // „Çπ„Ç±„Ç∏„É•„Éº„É´„ÅÆ„Éè„Ç§„É©„Ç§„Éà„Çí„É™„Çª„ÉÉ„Éà
        scheduleData.forEach((item, index) => {
            const div = document.getElementById(`schedule-${index}`);
            div.className = 'schedule-item';
        });
    }

    // „Éö„Éº„Ç∏Ë™≠„ÅøËæº„ÅøÊôÇ„Å´ÂàùÊúüÂåñ
    initSchedule();
    drawClock();
    
    // ÁèæÂú®ÊôÇÂàª„ÅÆË°®Á§∫„ÇíÊõ¥Êñ∞Ôºà„Çø„Ç§„Éû„ÉºÊú™Ëµ∑ÂãïÊôÇÔºâ
    setInterval(() => {
        if (!timerInterval) {
            drawClock();
        }
    }, 1000);
</script>
```

</body>
</html>
